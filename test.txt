@Bean
public HttpSessionSaml2AuthenticationRequestContextRepository samlRequestRepository() {
  return new HttpSessionSaml2AuthenticationRequestContextRepository();
}

-----

@Bean
public Saml2AuthenticationRequestResolver authenticationRequestResolver(
  RelyingPartyRegistrationRepository repo,
  HttpSessionSaml2AuthenticationRequestContextRepository repoForContext
) {
  OpenSaml4AuthenticationRequestResolver resolver =
    new OpenSaml4AuthenticationRequestResolver(repo);
  // tell it _where_ to save the request ID
  resolver.setAuthenticationRequestContextRepository(repoForContext);

  // your existing RelayState stuff…
  resolver.setRelayStateResolver(request -> { … });

  return resolver;
}


-----

server:
  servlet:
    session:
      cookie: 
        name: JSESSIONID
spring:
  session:
    store-type: jdbc
